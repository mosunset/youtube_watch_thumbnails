# データ分析ツール

Chrome拡張機能のインストール数データ（言語別・地域別）を分析するツールです。

## 概要

このツールは、Google Chrome Web Storeからダウンロードしたインストール数データのCSVファイルを分析し、詳細な統計情報をJSON形式で出力します。

## 機能

### 基本分析

- 各カテゴリ（言語/地域）の総インストール数
- 全体統計（総インストール数、日次平均、アクティブカテゴリ数など）

### 時系列分析

- **日次統計**: 平均、中央値、標準偏差、最大値、最小値、ピーク日
- **月次集計**: 月ごとのインストール数推移
- **年次集計**: 年ごとのインストール数推移
- **成長率**: 月次・年次の成長率（パーセント）

### カテゴリ別統計

各言語/地域ごとに以下の詳細統計を算出：

- 基本統計（総数、平均、中央値、標準偏差、最大値、最小値）
- ピーク日（最大インストール数が発生した日）
- 最初のアクティブ日・最後のアクティブ日
- 成長率（パーセント）
- アクティブ率（非ゼロ日数の割合）

### 上位カテゴリ分析

- 上位10カテゴリのリスト
- 上位Nの合計と全体に対する割合

## 必要な環境

- Python 3.10以上
- pandas >= 2.0.0
- numpy >= 1.24.0

## セットアップ

### 依存関係のインストール

```bash
# uvを使用する場合
cd Data
uv sync

# または pip を使用する場合
pip install pandas numpy
```

## 使用方法

### データの配置

CSVファイルを以下の構造で配置してください：

```
Data/
├── YYYYMMDD/              # ダウンロード日（フォルダ名）
│   ├── 言語別のインストール数_*.csv
│   └── 地域別のインストール数_*.csv
├── main.py
└── pyproject.toml
```

### 実行

```bash
cd Data
python main.py
```

または `uv` を使用する場合：

```bash
cd Data
uv run main.py
```

### 出力

分析結果は `Data/analysis_results/` ディレクトリにJSON形式で保存されます。

ファイル名: `analysis_all_YYYYMMDD_HHMMSS.json`

## 出力形式

### JSON構造

```json
[
  {
    "実行日": "2025/11/06 11:30:35",
    "ダウンロード日": "20251106",
    "分析タイプ": "言語別",
    "ファイル名": "言語別のインストール数_*.csv",
    "日付範囲_開始": "2020/11/07",
    "日付範囲_終了": "2025/11/05",
    "基本情報": {
      "各カテゴリの総数": {
        "日本語": 7862,
        "英語 (アメリカ合衆国)": 1478,
        ...
      },
      "全体統計": {
        "総インストール数": 10634,
        "総日数": 1825,
        "日次平均インストール数": 5.83,
        "カテゴリ数": 35,
        "アクティブカテゴリ数": 35
      }
    },
    "時系列分析": {
      "日次統計": {
        "平均": 5.83,
        "中央値": 5.0,
        "標準偏差": 12.23,
        "最大値": 437.0,
        "最小値": 0.0,
        "ピーク日": "2023/02/16",
        "ピーク日_インストール数": 437
      },
      "月次集計": [
        {
          "年月": "2020-11",
          "総インストール数": 0
        },
        ...
      ],
      "年次集計": [
        {
          "年": 2020,
          "総インストール数": 0
        },
        ...
      ],
      "月次成長率": {
        "成長率": 0.123,
        "成長率_パーセント": 12.3
      },
      "年次成長率": {
        "成長率": 0.456,
        "成長率_パーセント": 45.6
      }
    },
    "カテゴリ別統計": {
      "日本語": {
        "総数": 7862,
        "平均": 4.31,
        "中央値": 3.0,
        "標準偏差": 6.78,
        "最大値": 350,
        "最小値": 0,
        "ピーク日": "2023/02/16",
        "最初のアクティブ日": "2022/05/10",
        "最後のアクティブ日": "2025/11/05",
        "成長率": 0.234,
        "成長率_パーセント": 23.4,
        "非ゼロ日数": 1823,
        "総日数": 1825,
        "アクティブ率": 99.89
      },
      ...
    },
    "上位カテゴリ分析": {
      "上位10": [
        {
          "カテゴリ": "日本語",
          "総数": 7862
        },
        ...
      ],
      "合計": 10634,
      "上位Nの合計": 10500,
      "上位Nの割合_パーセント": 98.74
    }
  }
]
```

## CSVファイルの形式

CSVファイルは以下の形式である必要があります：

- 1行目: タイトル（例: "言語別のインストール数"）
- 2行目: ヘッダー（日付列 + 各カテゴリ列）
- 3行目以降: データ行（日付, 値1, 値2, ...）

例:

```csv
言語別のインストール数
日付,日本語,英語 (アメリカ合衆国),...
2020/11/07,0,0,...
2020/11/08,0,0,...
...
```

## 注意事項

- CSVファイルはUTF-8エンコーディングである必要があります
- 日付形式は `YYYY/MM/DD` である必要があります
- 複数のダウンロード日フォルダがあっても、すべて自動的に分析されます

## トラブルシューティング

### エンコーディングエラー

Windows環境で文字化けが発生する場合は、スクリプトが自動的にUTF-8に設定します。

### 依存関係エラー

```bash
# 依存関係を再インストール
pip install --upgrade pandas numpy
```

### CSVファイルが見つからない

- CSVファイルが正しいディレクトリ構造になっているか確認してください
- フォルダ名が日付形式（YYYYMMDD）になっているか確認してください
